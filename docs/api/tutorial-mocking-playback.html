<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Tutorial: Mocking Playback - Bigscreen Player</title>
    
    
    
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/bbc/bigscreen-player" target="_blank" class="menu-item" id="website_link" >Github</a></h2><h2><a href="https://www.npmjs.com/package/bigscreen-player" target="_blank" class="menu-item" id="forum_link" >NPM</a></h2><h3>Tutorials</h3><ul><li><a href="tutorial-adrs.html">ADRs</a></li><li><a href="tutorial-design.html">Design Overview</a></li><li><a href="tutorial-features.html">Features</a></li><li><a href="tutorial-installation.html">Getting Started</a></li><li><a href="tutorial-testing.html">Testing</a></li></ul><h3>Modules</h3><ul><li><a href="module-bigscreenplayer_bigscreenplayer.html">bigscreenplayer/bigscreenplayer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.canPause">canPause</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.canSeek">canSeek</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.convertEpochMsToVideoTimeSeconds">convertEpochMsToVideoTimeSeconds</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.convertVideoTimeSecondsToEpochMs">convertVideoTimeSecondsToEpochMs</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.getCurrentTime">getCurrentTime</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.getDuration">getDuration</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.getFrameworkVersion">getFrameworkVersion</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.getLiveWindowData">getLiveWindowData</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.getLogLevels">getLogLevels</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.getMediaKind">getMediaKind</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.getPlayerElement">getPlayerElement</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.getSeekableRange">getSeekableRange</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.getWindowType">getWindowType</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.isEnded">isEnded</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.isPaused">isPaused</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.isPlayingAtLiveEdge">isPlayingAtLiveEdge</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.isSubtitlesAvailable">isSubtitlesAvailable</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.isSubtitlesEnabled">isSubtitlesEnabled</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.mock">mock</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.mockJasmine">mockJasmine</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.pause">pause</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.play">play</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.registerForStateChanges">registerForStateChanges</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.registerForSubtitleChanges">registerForSubtitleChanges</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.registerForTimeUpdates">registerForTimeUpdates</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.registerPlugin">registerPlugin</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.setCurrentTime">setCurrentTime</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.setLogLevel">setLogLevel</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.setSubtitlesEnabled">setSubtitlesEnabled</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.setTransportControlsPosition">setTransportControlsPosition</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.toggleDebug">toggleDebug</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.transitions">transitions</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.unmock">unmock</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.unregisterForStateChanges">unregisterForStateChanges</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.unregisterForSubtitleChanges">unregisterForSubtitleChanges</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.unregisterForTimeUpdates">unregisterForTimeUpdates</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#.unregisterPlugin">unregisterPlugin</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#~init">init</a></li><li data-type='method' style='display: none;'><a href="module-bigscreenplayer_bigscreenplayer.html#~tearDown">tearDown</a></li></ul></li><li><a href="module-bigscreenplayer_models_windowtypes.html">bigscreenplayer/models/windowtypes</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Time">Time</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">Tutorial: Mocking Playback</h1>
    

    <section>

<header>
    

    <h2>Mocking Playback</h2>
</header>

<article>
    <h1>Mocking Playback</h1>
<p>When writing tests for your application it may be useful to use the mocking functions provided. This creates a fake player with mocking hook functions to simulate real world scenarios.</p>
<p>Bigscreen Player includes a test mode than can be triggered by calling <code>mock()</code> or <code>mockJasmine()</code>.</p>
<h2><code>mock(opts)</code> and <code>mockJasmine(opts)</code></h2>
<p><code>mockJasmine()</code> should be used when you want to mock Bigscreen Player within Jasmine tests. This turns each Bigsceen Player api function into a Jasmine spy, so you can call all the spy function on them e.g. <code>expect(BigscreenPlayer.play).toHaveBeenCalled()</code>.</p>
<p><code>mock()</code> should be used when you are not running Jasmine tests.</p>
<h3><code>opts</code></h3>
<ul>
<li><code>autoProgress = true|false</code> (optional; defaults to false) - playback will automatically progress after 100ms, transitioning into PLAYING, then updates the time every 500ms.</li>
</ul>
<h2><code>unmock()</code></h2>
<p>Should be called when you want to stop mocking Bigsceen Player, including in the <code>afterEach()</code> of Jasmine tests.</p>
<h2>Mocking hooks</h2>
<p>When Bigsceen Player has been mocked, there are various hooks added to the API in order to modify its behaviour or emulate certain real life scenarios.</p>
<h3><code>changeState(state, eventTrigger, opts)</code></h3>
<p>Hook for changing the state e.g. <code>BigscreenPlayer.changeState(MediaState.WAITING)</code> would emulate playback buffering.</p>
<ul>
<li><code>state = MediaState</code> - <a href="/models/mediastate.js">MediaState</a> to change to.</li>
<li><code>eventTrigger = 'device'|'other'</code> (optional; defaults to device) - determines whether the state change was caused by the device or not; affects <code>onBufferingCleared</code> and <code>onErrorCleared</code> plugin calls.</li>
</ul>
<h3><code>getSource()</code></h3>
<p>Get the URL of the current media.</p>
<h3><code>progressTime(time)</code></h3>
<p>Emulate playback jumping to a given <code>time</code>.</p>
<h3><code>setCanPause(value)</code></h3>
<p>Make <code>canPause()</code> return <code>value</code>.</p>
<h3><code>setCanSeek(value)</code></h3>
<p>Make <code>canSeek()</code> return <code>value</code>.</p>
<h3><code>setDuration(mediaDuration)</code></h3>
<p>Set the duration to <code>mediaDuration</code>.</p>
<h3><code>setEndOfStream(isEndOfStream)</code></h3>
<p>Sets the <code>endOfStream</code> value to be sent with events to <code>isEndOfStream</code>.</p>
<h3><code>setInitialBuffering(value)</code></h3>
<p>If Mock Bigsceen Player is setup to automatically progress, it will by default start progressing 100ms after <code>init()</code> has been called. If <code>setInitialBuffering(true)</code> is called, playback will not progress until something else causes it e.g. <code>play()</code> or <code>changeState(MediaState.PLAYING)</code>.</p>
<h3><code>setLiveWindowStart(value)</code></h3>
<p>Sets the live window start time to <code>value</code>; used in the calculation for <code>convertVideoTimeSecondsToEpochMs(seconds)</code>.</p>
<h3><code>setMediaKind(kind)</code></h3>
<p>Sets return value of <code>getMediaKind()</code> and <code>avType</code> for AV stats to <code>kind</code>.</p>
<h3><code>setSeekableRange(newSeekableRange)</code></h3>
<p>Set the seekable range to <code>newSeekableRange</code>.</p>
<ul>
<li><code>newSeekableRange</code>
<ul>
<li><code>start</code> - seekable range start</li>
<li><code>end</code> - seekable range end</li>
</ul>
</li>
</ul>
<h3><code>setWindowType(type)</code></h3>
<p>Sets the <a href="/models/windowtypes.js">WindowType</a>. Mock Bigsceen Player will behave differently for VOD, WEBCAST, and SIMULCAST as in production.</p>
<h3><code>setSubtitlesAvailable(value)</code></h3>
<p>Sets the return value of <code>isSubtitlesAvailable()</code> to <code>value</code>.</p>
<h3><code>triggerError()</code></h3>
<p>Triggers a non-fatal error which stalls playback. Will be dismissed when any call to Bigsceen Player is made which results in a state change, or with mocking hooks <code>changeState()</code> or <code>triggerErrorHandled()</code>.</p>
<h3><code>triggerErrorHandled()</code></h3>
<p>Makes Bigsceen Player handle an error - changes the URL if multiple were passed in, and the list hasn't already been exhausted, and resumes playback if Mock Bigsceen Player is automatically progressing.</p>
</article>

</section>

    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Thu Aug 05 2021 19:53:53 GMT+0100 (British Summer Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>