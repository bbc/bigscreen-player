<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Adding favicon -->
    

    <!-- Adding meta -->
    
    
    <meta name="description" content="Simplified media playback for bigscreen devices" />
    
    

    <!-- Adding external script-->
    

    <!-- Adding external style-->
    

    <!-- Adding scripts-->
    

    <!-- Adding style-->
    

    <!-- Adding overlay script-->
    

    <!-- Adding overlay style-->
    


    <title>
      bigscreenplayer.js
    </title>

    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/third-party/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/third-party/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/reset.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-base.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-dark.css">
    
    <svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    style="display:none">
    <defs>
        <symbol id="copy-icon" viewbox="0 0 488.3 488.3">
            <g>
                <path
                    d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z" />
                <path
                    d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z" />
            </g>
        </symbol>
        <symbol id='search-icon' viewBox="0 0 512 512">
            <g>
                <g>
                    <path
                        d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z" />
                </g>
            </g>
            <g>
                <g>
                    <path
                        d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z" />
                </g>
            </g>
        </symbol>
        <symbol id="down-icon" viewBox="0 0 16 16">
            <path 
                fill-rule="evenodd" 
                clip-rule="evenodd" 
                d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"
            >
            </path>
        </symbol>
    </defs>
</svg>
  </head>

  <body>

    <nav class="navbar" id="navbar">
      <h2><a href="index.html"><img src='bsp-logo.png'/></a></h2><div class="search-box" id="search-box"><div class="search-box-input-container"><input class="search-box-input" type="text" placeholder="Search..." id="search-box-input" /><svg class="search-icon" alt="search-icon"><use xlink:href="#search-icon"></use></svg></div><div class="search-item-container" id="search-item-container"><ul class="search-item-ul" id="search-item-ul"></ul></div></div><div class="sidebar-main-content" id="sidebar-main-content"><div class="accordion collapsed" id="5587359" > <h3 class="accordion-heading">Modules<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion collapsed child" id=6347735><div class="accordion-heading child"><a href="module-bigscreenplayer_bigscreenplayer.html">bigscreenplayer/bigscreenplayer</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#.getLiveSupport">getLiveSupport</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#.getLogLevels">getLogLevels</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#canPause">canPause</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#canSeek">canSeek</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#convertEpochMsToVideoTimeSeconds">convertEpochMsToVideoTimeSeconds</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#convertVideoTimeSecondsToEpochMs">convertVideoTimeSecondsToEpochMs</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#getCurrentTime">getCurrentTime</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#getDuration">getDuration</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#getFrameworkVersion">getFrameworkVersion</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#getLiveWindowData">getLiveWindowData</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#getMediaKind">getMediaKind</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#getPlayerElement">getPlayerElement</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#getSeekableRange">getSeekableRange</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#getWindowType">getWindowType</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#isEnded">isEnded</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#isPaused">isPaused</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#isPlayingAtLiveEdge">isPlayingAtLiveEdge</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#isSubtitlesAvailable">isSubtitlesAvailable</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#isSubtitlesEnabled">isSubtitlesEnabled</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#mock">mock</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#mockJasmine">mockJasmine</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#pause">pause</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#play">play</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#registerForStateChanges">registerForStateChanges</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#registerForSubtitleChanges">registerForSubtitleChanges</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#registerForTimeUpdates">registerForTimeUpdates</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#registerPlugin">registerPlugin</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#setCurrentTime">setCurrentTime</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#setSubtitlesEnabled">setSubtitlesEnabled</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#setTransportControlsPosition">setTransportControlsPosition</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#tearDown">tearDown</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#toggleDebug">toggleDebug</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#transitions">transitions</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#unmock">unmock</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#unregisterForStateChanges">unregisterForStateChanges</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#unregisterForSubtitleChanges">unregisterForSubtitleChanges</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#unregisterForTimeUpdates">unregisterForTimeUpdates</a></li><li data-type='method'><a href="module-bigscreenplayer_bigscreenplayer.html#unregisterPlugin">unregisterPlugin</a></li></ul></li></ul> </div><div class="accordion collapsed" id="4884323" > <h3 class="accordion-heading">Tutorials<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion-list" id=""><a href="tutorial-CDN Failover.html">CDN Failover</a></li><li class="accordion-list" id=""><a href="tutorial-Configuration.html">Configuration</a></li><li class="accordion-list" id=""><a href="tutorial-Debugging.html">Debugging</a></li><li class="accordion-list" id=""><a href="tutorial-Design.html">Design</a></li><li class="accordion-list" id=""><a href="tutorial-Events.html">Events</a></li><li class="accordion-list" id=""><a href="tutorial-Getting Started.html">Getting Started</a></li><li class="accordion-list" id=""><a href="tutorial-Mocking Playback.html">Mocking Playback</a></li><li class="accordion-list" id=""><a href="tutorial-Playback Strategies.html">Playback Strategies</a></li><li class="accordion-list" id=""><a href="tutorial-Plugins.html">Plugins</a></li><li class="accordion-list" id=""><a href="tutorial-State Changes.html">State Changes</a></li><li class="accordion-list" id=""><a href="tutorial-Testing.html">Testing</a></li></ul> </div><div class="accordion collapsed" id="7021088" > <h3 class="accordion-heading">Global<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion-list" id=""><a href="global.html#hasAttribute">hasAttribute</a></li><li class="accordion-list" id=""><a href="global.html#rgbaToRGB">rgbaToRGB</a></li><li class="accordion-list" id=""><a href="global.html#safeRemoveElement">safeRemoveElement</a></li><li class="accordion-list" id=""><a href="global.html#Time">Time</a></li><li class="accordion-list" id=""><a href="global.html#WindowTypes">WindowTypes</a></li></ul> </div>
      

    </nav>
    <div class="navbar-ham" id="navbar-ham">
      <div>
        <div class="first"></div>
        <div class="second"></div>
        <div class="third"></div>
      </div>
    </div>

    <div id="main" class="main-content">
      
      <h1 id='page-title' class="page-title">
        bigscreenplayer.js
      </h1>
      

      



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module bigscreenplayer/bigscreenplayer
 */
import MediaState from "./models/mediastate"
import PlayerComponent from "./playercomponent"
import PauseTriggers from "./models/pausetriggers"
import DynamicWindowUtils from "./dynamicwindowutils"
import WindowTypes from "./models/windowtypes"
import MockBigscreenPlayer from "./mockbigscreenplayer"
import Plugins from "./plugins"
import Chronicle from "./debugger/chronicle"
import DebugTool from "./debugger/debugtool"
import SlidingWindowUtils from "./utils/timeutils"
import callCallbacks from "./utils/callcallbacks"
import MediaSources from "./mediasources"
import Version from "./version"
import Resizer from "./resizer"
import ReadyHelper from "./readyhelper"
import Subtitles from "./subtitles/subtitles"

export default class BigscreenPlayer {
  static version = Version

  static END_OF_STREAM_TOLERANCE = 10

  /**
   * @return the live support of the device.
   */
  static getLiveSupport() {
    return PlayerComponent.getLiveSupport()
  }

  #stateChangeCallbacks = []
  #timeUpdateCallbacks = []
  #subtitleCallbacks = []
  #playerReadyCallback
  #playerErrorCallback
  #mediaKind
  #initialPlaybackTimeEpoch
  #serverDate
  #playerComponent
  #resizer
  #pauseTrigger
  #isSeeking = false
  #endOfStream
  #windowType
  #mediaSources
  #playbackElement
  #readyHelper
  #subtitles

  /**
   * @typedef {Object} MediaConnection
   * @property {String} url - media endpoint
   * @property {String} cdn - identifier for the endpoint
   */

  /**
   * Data required for playback
   * @typedef {Object} BigscreenPlayerData
   * @property {Object} media
   * @property {string} media.type - source type e.g 'application/dash+xml'
   * @property {string} media.mimeType - mimeType e.g 'video/mp4'
   * @property {string} media.kind - 'video' or 'audio'
   * @property {string} media.captionsUrl - 'Location for a captions file'
   * @property {MediaConnection[]} media.urls - Media urls to use
   * @property {Date} serverDate - Date object with server time offset
   * @property {WindowTypes} windowType
   * @property {boolean} subtitlesEnabled â€“ Enable subtitles on initialisation
   */

  /**
   *
   * @typedef {object} ConstructionCallbacks
   * @property {function} [callbacks.onSuccess] - Called after Bigscreen Player is initialised
   * @property {function} [callbacks.onError] - Called when an error occurs during initialisation
   */

  /**
   * Call first to initialise bigscreen player for playback.
   * @param {HTMLDivElement} el - The Div element where content elements should be rendered
   * @param {BigscreenPlayerData} data
   * @param {ConstructionCallbacks} callbacks
   */
  constructor(el, data, callbacks) {
    this.#playbackElement = el
    this.#resizer = Resizer()
    this.#windowType = data.windowType
    this.#serverDate = data.serverDate
    Chronicle.init()
    DebugTool.setRootElement(this.#playbackElement)
    DebugTool.keyValue({ key: "framework-version", value: Version })

    this.#playerReadyCallback = callbacks?.onSuccess?.bind(this)
    this.#playerErrorCallback = callbacks?.onError?.bind(this)

    // Backwards compatibility with Old API; to be removed on Major Version Update
    if (data.media &amp;&amp; !data.media.captions &amp;&amp; data.media.captionsUrl) {
      data.media.captions = [
        {
          url: data.media.captionsUrl,
        },
      ]
    }

    this.#mediaSources = MediaSources()

    const handleDataLoaded = this.#bigscreenPlayerDataLoaded.bind(this)

    const mediaSourceCallbacks = {
      onSuccess: () => handleDataLoaded(data),
      onError: (error) => {
        if (typeof callbacks?.onError === "function") {
          callbacks.onError(error)
        }
      },
    }

    this.#mediaSources.init(
      data.media,
      this.#serverDate,
      this.#windowType,
      BigscreenPlayer.getLiveSupport(),
      mediaSourceCallbacks
    )
  }

  #bigscreenPlayerDataLoaded(data) {
    if (this.#windowType !== WindowTypes.STATIC) {
      data.time = this.#mediaSources.time()

      this.#serverDate = data.serverDate
      this.#initialPlaybackTimeEpoch = data.initialPlaybackTime

      // overwrite initialPlaybackTime with video time (it comes in as epoch time for a sliding/growing window)
      data.initialPlaybackTime = SlidingWindowUtils.convertToSeekableVideoTime(
        data.initialPlaybackTime,
        data.time.windowStartTime
      )
    }

    this.#mediaKind = data.media.kind
    this.#endOfStream =
      this.#windowType !== WindowTypes.STATIC &amp;&amp; !data.initialPlaybackTime &amp;&amp; data.initialPlaybackTime !== 0

    this.#readyHelper = new ReadyHelper(
      data.initialPlaybackTime,
      this.#windowType,
      PlayerComponent.getLiveSupport(),
      this.#playerReadyCallback
    )

    this.#playerComponent = new PlayerComponent(
      this.#playbackElement,
      data,
      this.#mediaSources,
      this.#windowType,
      this.#mediaStateUpdateCallback.bind(this),
      this.#playerErrorCallback
    )

    this.#subtitles = Subtitles(
      this.#playerComponent,
      data.subtitlesEnabled,
      this.#playbackElement,
      data.media.subtitleCustomisation,
      this.#mediaSources,
      this.#callSubtitlesCallbacks.bind(this)
    )
  }

  #mediaStateUpdateCallback(event) {
    if (event.timeUpdate) {
      DebugTool.time(event.data.currentTime)
      callCallbacks(this.#timeUpdateCallbacks, {
        currentTime: event.data.currentTime,
        endOfStream: this.#endOfStream,
      })
    } else {
      let stateObject = { state: event.data.state }

      if (event.data.state === MediaState.PAUSED) {
        this.#endOfStream = false
        stateObject.trigger = this.#pauseTrigger || PauseTriggers.DEVICE
        this.#pauseTrigger = undefined
      }

      if (event.data.state === MediaState.FATAL_ERROR) {
        stateObject = {
          state: MediaState.FATAL_ERROR,
          isBufferingTimeoutError: event.isBufferingTimeoutError,
          code: event.code,
          message: event.message,
        }
      }

      if (event.data.state === MediaState.WAITING) {
        stateObject.isSeeking = this.#isSeeking
        this.#isSeeking = false
      }

      stateObject.endOfStream = this.#endOfStream
      DebugTool.event(stateObject)

      callCallbacks(this.#stateChangeCallbacks, stateObject)
    }

    if (event.data.seekableRange) {
      DebugTool.keyValue({ key: "seekableRangeStart", value: this.#deviceTimeToDate(event.data.seekableRange.start) })
      DebugTool.keyValue({ key: "seekableRangeEnd", value: this.#deviceTimeToDate(event.data.seekableRange.end) })
    }

    if (event.data.duration) {
      DebugTool.keyValue({ key: "duration", value: event.data.duration })
    }

    if (this.#playerComponent &amp;&amp; this.#readyHelper) {
      this.#readyHelper.callbackWhenReady(event)
    }
  }

  #deviceTimeToDate(time) {
    return this.#getWindowStartTime() ? new Date(this.convertVideoTimeSecondsToEpochMs(time)) : new Date(time * 1000)
  }

  #getWindowStartTime() {
    return this.#mediaSources &amp;&amp; this.#mediaSources.time().windowStartTime
  }

  #getWindowEndTime() {
    return this.#mediaSources &amp;&amp; this.#mediaSources.time().windowEndTime
  }

  #callSubtitlesCallbacks(enabled) {
    callCallbacks(this.#subtitleCallbacks, { enabled })
  }

  /**
   * Should be called at the end of all playback sessions. Resets state and clears any UI.
   */
  tearDown() {
    if (this.#subtitles) {
      this.#subtitles.tearDown()
      this.#subtitles = undefined
    }

    if (this.#playerComponent) {
      this.#playerComponent.tearDown()
      this.#playerComponent = undefined
    }

    if (this.#mediaSources) {
      this.#mediaSources.tearDown()
      this.#mediaSources = undefined
    }

    this.#stateChangeCallbacks = []
    this.#timeUpdateCallbacks = []
    this.#subtitleCallbacks = []
    this.#endOfStream = undefined
    this.#mediaKind = undefined
    this.#pauseTrigger = undefined
    this.#windowType = undefined
    this.#resizer = undefined
    this.unregisterPlugin()
    DebugTool.tearDown()
    Chronicle.tearDown()
  }

  /**
   * Pass a function to call whenever the player transitions state.
   * @see {@link module:models/mediastate}
   * @param {Function} callback
   */
  registerForStateChanges(callback) {
    this.#stateChangeCallbacks.push(callback)
    return callback
  }

  /**
   * Unregisters a previously registered callback.
   * @param {Function} callback
   */
  unregisterForStateChanges(callback) {
    const indexOf = this.#stateChangeCallbacks.indexOf(callback)
    if (indexOf !== -1) {
      this.#stateChangeCallbacks.splice(indexOf, 1)
    }
  }

  /**
   * Pass a function to call whenever the player issues a time update.
   * @param {Function} callback
   */
  registerForTimeUpdates(callback) {
    this.#timeUpdateCallbacks.push(callback)
    return callback
  }

  /**
   * Unregisters a previously registered callback.
   * @param {Function} callback
   */
  unregisterForTimeUpdates(callback) {
    const indexOf = this.#timeUpdateCallbacks.indexOf(callback)
    if (indexOf !== -1) {
      this.#timeUpdateCallbacks.splice(indexOf, 1)
    }
  }

  /**
   * Pass a function to be called whenever subtitles are enabled or disabled.
   * @param {Function} callback
   */
  registerForSubtitleChanges(callback) {
    this.#subtitleCallbacks.push(callback)
    return callback
  }

  /**
   * Unregisters a previously registered callback for changes to subtitles.
   * @param {Function} callback
   */
  unregisterForSubtitleChanges(callback) {
    const indexOf = this.#subtitleCallbacks.indexOf(callback)
    if (indexOf !== -1) {
      this.#subtitleCallbacks.splice(indexOf, 1)
    }
  }

  /**
   * Sets the current time of the media asset.
   * @param {Number} time - In seconds
   */
  setCurrentTime(time) {
    DebugTool.apicall("setCurrentTime")
    if (this.#playerComponent) {
      // this flag must be set before calling into playerComponent.setCurrentTime
      // as this synchronously fires a WAITING event (when native strategy).
      this.#isSeeking = true
      this.#playerComponent.setCurrentTime(time)
      this.#endOfStream =
        this.#windowType !== WindowTypes.STATIC &amp;&amp;
        Math.abs(this.getSeekableRange().end - time) &lt; BigscreenPlayer.END_OF_STREAM_TOLERANCE
    }
  }

  setPlaybackRate(rate) {
    this.#playerComponent?.setPlaybackRate(rate)
  }

  getPlaybackRate() {
    return this.#playerComponent?.getPlaybackRate()
  }

  /**
   * Returns the media asset's current time in seconds.
   */
  getCurrentTime() {
    return this.#playerComponent?.getCurrentTime() ?? 0
  }

  /**
   * Returns the current media kind.
   * 'audio' or 'video'
   */
  getMediaKind() {
    return this.#mediaKind
  }

  /**
   * Returns the current window type.
   * @see {@link module:bigscreenplayer/models/windowtypes}
   */
  getWindowType() {
    return this.#windowType
  }

  /**
   * Returns an object including the current start and end times.
   * @returns {Object} {start: Number, end: Number}
   */
  getSeekableRange() {
    return this.#playerComponent?.getSeekableRange() ?? {}
  }

  /**
   * @returns {boolean} Returns true if media is initialised and playing a live stream within a tolerance of the end of the seekable range (10 seconds).
   */
  isPlayingAtLiveEdge() {
    return !!(
      this.#playerComponent &amp;&amp;
      this.#windowType !== WindowTypes.STATIC &amp;&amp;
      Math.abs(this.getSeekableRange().end - this.getCurrentTime()) &lt; BigscreenPlayer.END_OF_STREAM_TOLERANCE
    )
  }

  /**
   * @return {Object} An object of the shape {windowStartTime: Number, windowEndTime: Number, initialPlaybackTime: Number, serverDate: Date}
   */
  getLiveWindowData() {
    if (this.#windowType === WindowTypes.STATIC) {
      return {}
    }

    return {
      windowStartTime: this.#getWindowStartTime(),
      windowEndTime: this.#getWindowEndTime(),
      initialPlaybackTime: this.#initialPlaybackTimeEpoch,
      serverDate: this.#serverDate,
    }
  }

  /**
   * @returns the duration of the media asset.
   */
  getDuration() {
    return this.#playerComponent?.getDuration()
  }

  /**
   * @returns if the player is paused.
   */
  isPaused() {
    return this.#playerComponent?.isPaused() ?? true
  }

  /**
   * @returns if the media asset has ended.
   */
  isEnded() {
    return this.#playerComponent?.isEnded() ?? false
  }

  /**
   * Play the media assest from the current point in time.
   */
  play() {
    DebugTool.apicall("play")
    this.#playerComponent.play()
  }

  /**
   * Pause the media asset.
   * @param {*} opts
   * @param {boolean} opts.userPause
   * @param {boolean} opts.disableAutoResume
   */
  pause(opts) {
    DebugTool.apicall("pause")
    this.#pauseTrigger = opts?.userPause === false ? PauseTriggers.APP : PauseTriggers.USER
    this.#playerComponent.pause(opts)
  }

  resize(top, left, width, height, zIndex) {
    this.#subtitles.hide()
    this.#resizer.resize(this.#playbackElement, top, left, width, height, zIndex)
  }

  clearResize() {
    if (this.#subtitles.enabled()) this.#subtitles.show()
    else this.#subtitles.hide()

    this.#resizer.clear(this.#playbackElement)
  }

  /**
   * Set whether or not subtitles should be enabled.
   * @param {boolean} value
   */
  setSubtitlesEnabled(enabled) {
    if (enabled) this.#subtitles.enable()
    else this.#subtitles.disable()

    this.#callSubtitlesCallbacks(enabled)

    if (this.#resizer.isResized()) {
      return
    }

    if (enabled) this.#subtitles.show()
    else this.#subtitles.hide()
  }

  /**
   * @return if subtitles are currently enabled.
   */
  isSubtitlesEnabled() {
    return this.#subtitles ? this.#subtitles.enabled() : false
  }

  /**
   * @return Returns whether or not subtitles are currently enabled.
   */
  isSubtitlesAvailable() {
    return this.#subtitles ? this.#subtitles.available() : false
  }

  areSubtitlesCustomisable() {
    return !window.bigscreenPlayer?.overrides?.legacySubtitles
  }

  customiseSubtitles(styleOpts) {
    if (this.#subtitles) {
      this.#subtitles.customise(styleOpts)
    }
  }

  renderSubtitleExample(xmlString, styleOpts, safePosition) {
    if (this.#subtitles) {
      this.#subtitles.renderExample(xmlString, styleOpts, safePosition)
    }
  }

  clearSubtitleExample() {
    if (this.#subtitles) {
      this.#subtitles.clearExample()
    }
  }

  /**
   *
   * An enum may be used to set the on-screen position of any transport controls
   * (work in progress to remove this - UI concern).
   * @param {*} position
   */
  setTransportControlsPosition(position) {
    if (this.#subtitles) {
      this.#subtitles.setPosition(position)
    }
  }

  /**
   * @return Returns whether the current media asset is seekable.
   */
  canSeek() {
    return (
      this.#windowType === WindowTypes.STATIC ||
      DynamicWindowUtils.canSeek(
        this.#getWindowStartTime(),
        this.#getWindowEndTime(),
        BigscreenPlayer.getLiveSupport(),
        this.getSeekableRange()
      )
    )
  }

  /**
   * @return Returns whether the current media asset is pausable.
   */
  canPause() {
    return (
      this.#windowType === WindowTypes.STATIC ||
      DynamicWindowUtils.canPause(
        this.#getWindowStartTime(),
        this.#getWindowEndTime(),
        BigscreenPlayer.getLiveSupport()
      )
    )
  }

  /**
   * Return a mock for in place testing.
   * @param {*} opts
   */
  mock(opts) {
    MockBigscreenPlayer.mock(this, opts)
  }

  /**
   * Unmock the player.
   */
  unmock() {
    MockBigscreenPlayer.unmock(this)
  }

  /**
   * Return a mock for unit tests.
   * @param {*} opts
   */
  mockJasmine(opts) {
    MockBigscreenPlayer.mockJasmine(this, opts)
  }

  /**
   * Register a plugin for extended events.
   * @param {*} plugin
   */
  registerPlugin(plugin) {
    Plugins.registerPlugin(plugin)
  }

  /**
   * Unregister a previously registered plugin.
   * @param {*} plugin
   */
  unregisterPlugin(plugin) {
    Plugins.unregisterPlugin(plugin)
  }

  /**
   * Returns an object with a number of functions related to the ability to transition state
   * given the current state and the playback strategy in use.
   */
  transitions() {
    return this.#playerComponent?.transitions() ?? {}
  }

  /**
   * @return The media element currently being used.
   */
  getPlayerElement() {
    return this.#playerComponent?.getPlayerElement()
  }

  /**
   * @param {Number} epochTime - Unix Epoch based time in milliseconds.
   * @return the time in seconds within the current sliding window.
   */
  convertEpochMsToVideoTimeSeconds(epochTime) {
    return this.#getWindowStartTime() ? Math.floor((epochTime - this.#getWindowStartTime()) / 1000) : null
  }

  /**
   * @return The runtime version of the library.
   */
  getFrameworkVersion() {
    return Version
  }

  /**
   * @param {Number} time - Seconds
   * @return the time in milliseconds within the current sliding window.
   */
  convertVideoTimeSecondsToEpochMs(seconds) {
    return this.#getWindowStartTime() ? this.#getWindowStartTime() + seconds * 1000 : null
  }

  /**
   * Toggle the visibility of the debug tool overlay.
   */
  toggleDebug() {
    if (this.#playerComponent) {
      DebugTool.toggleVisibility()
    }
  }

  /**
   * @return {Object} - Key value pairs of available log levels
   */
  static getLogLevels() {
    return DebugTool.logLevels
  }

  /**
   * @borrows DebugTool.setLogLevel as setLogLevel
   * @param logLevel -  log level to display @see getLogLevels
   */
  static setLogLevel = DebugTool.setLogLevel

  static getDebugLogs() {
    return Chronicle.retrieve()
  }
}
</code></pre>
        </article>
    </section>




    </div>

    <footer class="footer" id="footer">
      
    </footer>

    <script src="scripts/third-party/prettify.js"></script>
    <script src="scripts/third-party/lang-css.js"></script>
    <script type="text/javascript" src="scripts/misc.js"></script>

    <script>prettyPrint();</script>
    <script src="scripts/linenumber.js"></script>
    <script src="scripts/fix-code-block.js"></script>
    <script src="scripts/fix-navbar.js"></script>
    
      <script src="scripts/search.js"></script>
      <script src="scripts/third-party/fuse.js"></script>
      <script>
        var list = [{"title":"bigscreenplayer/bigscreenplayer","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html\">bigscreenplayer/bigscreenplayer</a>"},{"title":"module:bigscreenplayer/bigscreenplayer.getLiveSupport","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#.getLiveSupport\">module:bigscreenplayer/bigscreenplayer &rtrif; getLiveSupport</a>"},{"title":"module:bigscreenplayer/bigscreenplayer.getLogLevels","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#.getLogLevels\">module:bigscreenplayer/bigscreenplayer &rtrif; getLogLevels</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#canPause","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#canPause\">module:bigscreenplayer/bigscreenplayer &rtrif; canPause</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#canSeek","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#canSeek\">module:bigscreenplayer/bigscreenplayer &rtrif; canSeek</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#convertEpochMsToVideoTimeSeconds","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#convertEpochMsToVideoTimeSeconds\">module:bigscreenplayer/bigscreenplayer &rtrif; convertEpochMsToVideoTimeSeconds</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#convertVideoTimeSecondsToEpochMs","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#convertVideoTimeSecondsToEpochMs\">module:bigscreenplayer/bigscreenplayer &rtrif; convertVideoTimeSecondsToEpochMs</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#getCurrentTime","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#getCurrentTime\">module:bigscreenplayer/bigscreenplayer &rtrif; getCurrentTime</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#getDuration","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#getDuration\">module:bigscreenplayer/bigscreenplayer &rtrif; getDuration</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#getFrameworkVersion","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#getFrameworkVersion\">module:bigscreenplayer/bigscreenplayer &rtrif; getFrameworkVersion</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#getLiveWindowData","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#getLiveWindowData\">module:bigscreenplayer/bigscreenplayer &rtrif; getLiveWindowData</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#getMediaKind","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#getMediaKind\">module:bigscreenplayer/bigscreenplayer &rtrif; getMediaKind</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#getPlayerElement","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#getPlayerElement\">module:bigscreenplayer/bigscreenplayer &rtrif; getPlayerElement</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#getSeekableRange","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#getSeekableRange\">module:bigscreenplayer/bigscreenplayer &rtrif; getSeekableRange</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#getWindowType","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#getWindowType\">module:bigscreenplayer/bigscreenplayer &rtrif; getWindowType</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#isEnded","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#isEnded\">module:bigscreenplayer/bigscreenplayer &rtrif; isEnded</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#isPaused","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#isPaused\">module:bigscreenplayer/bigscreenplayer &rtrif; isPaused</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#isPlayingAtLiveEdge","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#isPlayingAtLiveEdge\">module:bigscreenplayer/bigscreenplayer &rtrif; isPlayingAtLiveEdge</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#isSubtitlesAvailable","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#isSubtitlesAvailable\">module:bigscreenplayer/bigscreenplayer &rtrif; isSubtitlesAvailable</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#isSubtitlesEnabled","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#isSubtitlesEnabled\">module:bigscreenplayer/bigscreenplayer &rtrif; isSubtitlesEnabled</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#mock","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#mock\">module:bigscreenplayer/bigscreenplayer &rtrif; mock</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#mockJasmine","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#mockJasmine\">module:bigscreenplayer/bigscreenplayer &rtrif; mockJasmine</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#pause","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#pause\">module:bigscreenplayer/bigscreenplayer &rtrif; pause</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#play","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#play\">module:bigscreenplayer/bigscreenplayer &rtrif; play</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#registerForStateChanges","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#registerForStateChanges\">module:bigscreenplayer/bigscreenplayer &rtrif; registerForStateChanges</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#registerForSubtitleChanges","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#registerForSubtitleChanges\">module:bigscreenplayer/bigscreenplayer &rtrif; registerForSubtitleChanges</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#registerForTimeUpdates","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#registerForTimeUpdates\">module:bigscreenplayer/bigscreenplayer &rtrif; registerForTimeUpdates</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#registerPlugin","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#registerPlugin\">module:bigscreenplayer/bigscreenplayer &rtrif; registerPlugin</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#setCurrentTime","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#setCurrentTime\">module:bigscreenplayer/bigscreenplayer &rtrif; setCurrentTime</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#setSubtitlesEnabled","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#setSubtitlesEnabled\">module:bigscreenplayer/bigscreenplayer &rtrif; setSubtitlesEnabled</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#setTransportControlsPosition","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#setTransportControlsPosition\">module:bigscreenplayer/bigscreenplayer &rtrif; setTransportControlsPosition</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#tearDown","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#tearDown\">module:bigscreenplayer/bigscreenplayer &rtrif; tearDown</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#toggleDebug","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#toggleDebug\">module:bigscreenplayer/bigscreenplayer &rtrif; toggleDebug</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#transitions","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#transitions\">module:bigscreenplayer/bigscreenplayer &rtrif; transitions</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#unmock","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#unmock\">module:bigscreenplayer/bigscreenplayer &rtrif; unmock</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#unregisterForStateChanges","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#unregisterForStateChanges\">module:bigscreenplayer/bigscreenplayer &rtrif; unregisterForStateChanges</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#unregisterForSubtitleChanges","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#unregisterForSubtitleChanges\">module:bigscreenplayer/bigscreenplayer &rtrif; unregisterForSubtitleChanges</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#unregisterForTimeUpdates","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#unregisterForTimeUpdates\">module:bigscreenplayer/bigscreenplayer &rtrif; unregisterForTimeUpdates</a>"},{"title":"module:bigscreenplayer/bigscreenplayer#unregisterPlugin","link":"<a href=\"module-bigscreenplayer_bigscreenplayer.html#unregisterPlugin\">module:bigscreenplayer/bigscreenplayer &rtrif; unregisterPlugin</a>"},{"title":"CDN Failover","link":"CDN Failover"},{"title":"Configuration","link":"Configuration"},{"title":"Debugging","link":"Debugging"},{"title":"Design","link":"Design"},{"title":"Events","link":"Events"},{"title":"Getting Started","link":"Getting Started"},{"title":"Mocking Playback","link":"Mocking Playback"},{"title":"Playback Strategies","link":"Playback Strategies"},{"title":"Plugins","link":"Plugins"},{"title":"State Changes","link":"State Changes"},{"title":"Testing","link":"Testing"},{"title":"hasAttribute","link":"<a href=\"global.html#hasAttribute\">hasAttribute</a>"},{"title":"rgbaToRGB","link":"<a href=\"global.html#rgbaToRGB\">rgbaToRGB</a>"},{"title":"safeRemoveElement","link":"<a href=\"global.html#safeRemoveElement\">safeRemoveElement</a>"},{"title":"Time","link":"<a href=\"global.html#Time\">Time</a>"},{"title":"WindowTypes","link":"<a href=\"global.html#WindowTypes\">WindowTypes</a>"}];
        var options = {"shouldSort":true,"threshold":0.4,"location":0,"distance":100,"maxPatternLength":32,"minMatchCharLength":1}
          setupSearch(list, options)
      </script>
    

    

    

    


  </body>

</html>
